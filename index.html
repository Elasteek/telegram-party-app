<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –Ω–∞ –≤–µ—á–µ—Ä–∏–Ω–∫–∏</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Roboto', Arial, sans-serif;
        }
        
        body {
            background-color: #f5f5f5;
            color: #333;
            padding: 20px;
            max-width: 500px;
            margin: 0 auto;
        }
        
        .dark-theme {
            background-color: #212121;
            color: #fff;
        }
        
        .header {
            text-align: center;
            margin-bottom: 20px;
        }
        
        .party-list {
            margin-bottom: 20px;
        }
        
        .party-card {
            background-color: #fff;
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 15px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            transition: transform 0.2s;
        }
        
        .dark-theme .party-card {
            background-color: #333;
        }
        
        .party-card:hover {
            transform: translateY(-3px);
        }
        
        .party-title {
            font-size: 18px;
            font-weight: bold;
            margin-bottom: 5px;
        }
        
        .party-date, .party-location, .party-description {
            margin-bottom: 5px;
            font-size: 14px;
        }
        
        .party-description {
            margin-bottom: 15px;
        }
        
        button {
            background-color: #389ce9;
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 5px;
            cursor: pointer;
            width: 100%;
            font-size: 16px;
        }
        
        button:hover {
            background-color: #2d88d3;
        }
        
        .form-container {
            background-color: #fff;
            border-radius: 10px;
            padding: 20px;
            margin-top: 20px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            display: none;
        }
        
        .dark-theme .form-container {
            background-color: #333;
        }
        
        .form-group {
            margin-bottom: 15px;
        }
        
        label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }
        
        input, select, textarea {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 16px;
        }
        
        .dark-theme input, .dark-theme select, .dark-theme textarea {
            background-color: #212121;
            border-color: #444;
            color: #fff;
        }
        
        .success-message {
            background-color: #4CAF50;
            color: white;
            padding: 10px;
            border-radius: 5px;
            margin-top: 20px;
            text-align: center;
            display: none;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –Ω–∞ –≤–µ—á–µ—Ä–∏–Ω–∫–∏</h1>
        <p>–í—ã–±–µ—Ä–∏—Ç–µ —Å–æ–±—ã—Ç–∏–µ –∏–∑ —Å–ø–∏—Å–∫–∞ –Ω–∏–∂–µ</p>
    </div>

    <div class="party-list" id="partyList">
        <!-- –ó–¥–µ—Å—å –±—É–¥—É—Ç –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –¥–æ–±–∞–≤–ª—è—Ç—å—Å—è –∫–∞—Ä—Ç–æ—á–∫–∏ –≤–µ—á–µ—Ä–∏–Ω–æ–∫ -->
    </div>

    <div class="form-container" id="registrationForm">
        <h2 id="formTitle">–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –Ω–∞ –≤–µ—á–µ—Ä–∏–Ω–∫—É</h2>
        <div class="form-group">
            <label for="name">–ò–º—è –∏ –§–∞–º–∏–ª–∏—è</label>
            <input type="text" id="name" placeholder="–í–≤–µ–¥–∏—Ç–µ –≤–∞—à–µ –∏–º—è –∏ —Ñ–∞–º–∏–ª–∏—é" required>
        </div>
        <div class="form-group">
            <label for="phone">–¢–µ–ª–µ—Ñ–æ–Ω</label>
            <input type="tel" id="phone" placeholder="+7XXXXXXXXXX" required>
        </div>
        <div class="form-group">
            <label for="email">Email</label>
            <input type="email" id="email" placeholder="example@mail.ru" required>
        </div>
        <div class="form-group">
            <label for="guests">–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –≥–æ—Å—Ç–µ–π</label>
            <select id="guests">
                <option value="1">1</option>
                <option value="2">2</option>
                <option value="3">3</option>
                <option value="4">4</option>
                <option value="5+">5 –∏ –±–æ–ª–µ–µ</option>
            </select>
        </div>
        <div class="form-group">
            <label for="comments">–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏</label>
            <textarea id="comments" rows="3" placeholder="–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è"></textarea>
        </div>
        <button type="button" id="submitBtn">–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è</button>
        <button type="button" id="backBtn" style="margin-top: 10px; background-color: #6c757d;">–ù–∞–∑–∞–¥ –∫ —Å–ø–∏—Å–∫—É</button>
    </div>

    <div class="success-message" id="successMessage">
        –í—ã —É—Å–ø–µ—à–Ω–æ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–ª–∏—Å—å –Ω–∞ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–µ!
    </div>

    <script>
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Telegram Mini App
        let tg = window.Telegram.WebApp;
        tg.expand();
        
        // –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ —Ç–µ–º—ã Telegram
        if (tg.colorScheme === 'dark') {
            document.body.classList.add('dark-theme');
        }
        
        // –î–∞–Ω–Ω—ã–µ –æ –≤–µ—á–µ—Ä–∏–Ω–∫–∞—Ö (–≤ —Ä–µ–∞–ª—å–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –±—É–¥—É—Ç –∑–∞–≥—Ä—É–∂–∞—Ç—å—Å—è —Å —Å–µ—Ä–≤–µ—Ä–∞)
        const parties = [
            {
                id: 1,
                title: "–ù–æ–≤–æ–≥–æ–¥–Ω—è—è –≤–µ—á–µ—Ä–∏–Ω–∫–∞",
                date: "31.12.2024, 22:00",
                location: "–ö–ª—É–± ¬´–ö–æ—Å–º–æ—Å¬ª, —É–ª. –õ–µ–Ω–∏–Ω–∞, 20",
                description: "–í—Å—Ç—Ä–µ—á–∞–µ–º –ù–æ–≤—ã–π –ì–æ–¥ –≤ –∫—Ä—É–≥—É –¥—Ä—É–∑–µ–π —Å —à–∞–º–ø–∞–Ω—Å–∫–∏–º –∏ —Ñ–µ–π–µ—Ä–≤–µ—Ä–∫–∞–º–∏!"
            },
            {
                id: 2,
                title: "–ü–µ–Ω–Ω–∞—è –≤–µ—á–µ—Ä–∏–Ω–∫–∞",
                date: "15.06.2024, 18:00",
                location: "–ü–ª—è–∂–Ω—ã–π –∫–ª—É–± ¬´–í–æ–ª–Ω–∞¬ª, –ù–∞–±–µ—Ä–µ–∂–Ω–∞—è, 5",
                description: "–õ–µ—Ç–æ, –ø–µ–Ω–∞, –º—É–∑—ã–∫–∞ –∏ –±–µ–∑—É–¥–µ—Ä–∂–Ω–æ–µ –≤–µ—Å–µ–ª—å–µ –Ω–∞ –æ—Ç–∫—Ä—ã—Ç–æ–º –≤–æ–∑–¥—É—Ö–µ!"
            },
            {
                id: 3,
                title: "–¢–µ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –≤–µ—á–µ—Ä–∏–Ω–∫–∞ 80-—Ö",
                date: "20.05.2024, 20:00",
                location: "–†–µ—Ç—Ä–æ-–±–∞—Ä ¬´–í–∏–Ω–∏–ª¬ª, –ø—Ä. –ü–æ–±–µ–¥—ã, 10",
                description: "–Ø—Ä–∫–∏–µ –∫–æ—Å—Ç—é–º—ã, –¥–∏—Å–∫–æ-–º—É–∑—ã–∫–∞ –∏ –∞—Ç–º–æ—Å—Ñ–µ—Ä–∞ –±–µ–∑–∑–∞–±–æ—Ç–Ω—ã—Ö 80-—Ö!"
            }
        ];
        
        // –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –≤–µ—á–µ—Ä–∏–Ω–æ–∫
        function renderPartyList() {
            const partyListContainer = document.getElementById('partyList');
            partyListContainer.innerHTML = '';
            
            parties.forEach(party => {
                const partyCard = document.createElement('div');
                partyCard.className = 'party-card';
                partyCard.innerHTML = `
                    <div class="party-title">${party.title}</div>
                    <div class="party-date">üìÖ ${party.date}</div>
                    <div class="party-location">üìç ${party.location}</div>
                    <div class="party-description">${party.description}</div>
                    <button class="register-btn" data-id="${party.id}">–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è</button>
                `;
                partyListContainer.appendChild(partyCard);
            });
            
            // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ –¥–ª—è –∫–Ω–æ–ø–æ–∫ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏
            document.querySelectorAll('.register-btn').forEach(button => {
                button.addEventListener('click', function() {
                    const partyId = this.getAttribute('data-id');
                    showRegistrationForm(partyId);
                });
            });
        }
        
        // –ü–æ–∫–∞–∑–∞—Ç—å —Ñ–æ—Ä–º—É —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏
        function showRegistrationForm(partyId) {
            const party = parties.find(p => p.id == partyId);
            document.getElementById('partyList').style.display = 'none';
            document.getElementById('registrationForm').style.display = 'block';
            document.getElementById('formTitle').textContent = `–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è: ${party.title}`;
            
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º ID –≤–µ—á–µ—Ä–∏–Ω–∫–∏ –¥–ª—è —Ñ–æ—Ä–º—ã
            document.getElementById('registrationForm').setAttribute('data-party-id', partyId);
        }
        
        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–Ω–æ–ø–∫–∏ "–ù–∞–∑–∞–¥"
        document.getElementById('backBtn').addEventListener('click', function() {
            document.getElementById('partyList').style.display = 'block';
            document.getElementById('registrationForm').style.display = 'none';
            document.getElementById('successMessage').style.display = 'none';
        });
        
        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –æ—Ç–ø—Ä–∞–≤–∫–∏ —Ñ–æ—Ä–º—ã
        document.getElementById('submitBtn').addEventListener('click', function() {
            // –í–∞–ª–∏–¥–∞—Ü–∏—è —Ñ–æ—Ä–º—ã
            const name = document.getElementById('name').value;
            const phone = document.getElementById('phone').value;
            const email = document.getElementById('email').value;
            
            if (!name || !phone || !email) {
                alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∑–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è');
                return;
            }
            
            // –°–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö —Ñ–æ—Ä–º—ã
            const partyId = document.getElementById('registrationForm').getAttribute('data-party-id');
            const guests = document.getElementById('guests').value;
            const comments = document.getElementById('comments').value;
            
            // –°–æ–∑–¥–∞–Ω–∏–µ –æ–±—ä–µ–∫—Ç–∞ —Å –¥–∞–Ω–Ω—ã–º–∏ –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏
            const formData = {
                partyId,
                name,
                phone,
                email,
                guests,
                comments
            };
            
            // –í —Ä–µ–∞–ª—å–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –∑–¥–µ—Å—å –±—ã–ª –±—ã –∑–∞–ø—Ä–æ—Å –∫ —Å–µ—Ä–≤–µ—Ä—É
            console.log('–û—Ç–ø—Ä–∞–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö:', formData);
            
            // –ò–º–∏—Ç–∞—Ü–∏—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –Ω–∞ —Å–µ—Ä–≤–µ—Ä
            setTimeout(() => {
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± —É—Å–ø–µ—Ö–µ
                document.getElementById('registrationForm').style.display = 'none';
                document.getElementById('successMessage').style.display = 'block';
                
                // –û—Ç–ø—Ä–∞–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö –≤ Telegram
                if (tg.isExpanded) {
                    const party = parties.find(p => p.id == partyId);
                    tg.sendData(JSON.stringify({
                        action: 'register',
                        party: party.title,
                        userData: formData
                    }));
                }
                
                // –û—á–∏—Å—Ç–∫–∞ —Ñ–æ—Ä–º—ã
                document.getElementById('name').value = '';
                document.getElementById('phone').value = '';
                document.getElementById('email').value = '';
                document.getElementById('guests').value = '1';
                document.getElementById('comments').value = '';
                
                // –í–æ–∑–≤—Ä–∞—Ç –∫ —Å–ø–∏—Å–∫—É —á–µ—Ä–µ–∑ 3 —Å–µ–∫—É–Ω–¥—ã
                setTimeout(() => {
                    document.getElementById('partyList').style.display = 'block';
                    document.getElementById('successMessage').style.display = 'none';
                }, 3000);
            }, 1000);
        });
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
        window.onload = function() {
            renderPartyList();
            
            // –°–æ–æ–±—â–∞–µ–º Telegram, —á—Ç–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –≥–æ—Ç–æ–≤–æ
            tg.ready();
        };
    </script>
</body>
</html>
